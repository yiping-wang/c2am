# Environment
seed: 0
voc12_root: "/u8/y3967wang/dataset/VOCdevkit/VOC2012/"
model_root: "/u8/y3967wang/output/model"
cam_out_dir: "/u8/y3967wang/output/CAM_C2AM/"
scam_out_dir: "/u8/y3967wang/output/Global_CAM/"
ir_label_out_dir: "/u8/y3967wang/output/IRLabel_C2AM/"
sem_seg_out_dir: "/u8/y3967wang/output/SemSeg_C2AM/"

# Dataset
train_list: "voc12/train_aug.txt"
val_list: "voc12/val.txt"
infer_list: "voc12/train.txt" # "voc12/train.txt"
chainer_eval_set: "train"     # "train"

# Class Activation Map
start_weight_name: "resnet50_cam.pth"
cam_weights_name: "resnet50_c2am_reproduce.pth"
laste_cam_weights_name: "resnet50_c2am_reproduce.pth"
scam_name: "global_cam.npy"
num_workers: 12
gamma: 1
cam_scales: [1.0, 0.5, 1.5, 2.0, 2.5, 3.0]
cam_square_shape: 128
cam_crop_size: 512
cam_batch_size: 16
cam_num_epoches: 4
cam_learning_rate: 0.0005
cam_weight_decay: 0.0001

# IRNet
irn_weights_name: "irn_c2am_reproduce.pth"
num_workers: 12
conf_fg_thres: 0.38
conf_bg_thres: 0.10
irn_crop_size: 512
irn_batch_size: 32
irn_num_epoches: 3
irn_learning_rate: 0.1
irn_weight_decay: 0.0001
beta: 10
exp_times: 8
sem_seg_bg_thres: 0.25

# gamma: 1
# python3 eval_cam.py --config    ./cfg/c2am_reproduce.yml --cam_eval_thres 0.13
# {'iou': array([0.79324509, 0.43749124, 0.29972142, 0.49097028, 0.33891135,
#        0.50836458, 0.69542451, 0.56681332, 0.58999821, 0.2781992 ,
#        0.62624782, 0.45399818, 0.56097877, 0.58421195, 0.63985056,
#        0.56595787, 0.43250425, 0.6533794 , 0.4806589 , 0.50096507,
#        0.44343288]), 'miou': 0.5210154693754724}

# conf_fg_thres: 0.35
# conf_bg_thres: 0.05
# sem_seg_bg_thres: 0.20
# {'iou': array([0.88074762, 0.66178405, 0.39633498, 0.78040101, 0.55053657,
#        0.65559738, 0.84086211, 0.73863667, 0.84700235, 0.38748363,
#        0.85876872, 0.50691215, 0.80890559, 0.84626869, 0.79845058,
#        0.71130295, 0.54378442, 0.84657932, 0.64624727, 0.62093452,
#        0.50329979]), 'miou': 0.6871828753387268}

# conf_fg_thres: 0.38
# conf_bg_thres: 0.15
# sem_seg_bg_thres: 0.20
# {'iou': array([0.88844262, 0.7654841 , 0.38608168, 0.78611774, 0.58365895,
#        0.64395777, 0.83670109, 0.73970515, 0.80342204, 0.38069992,
#        0.84941827, 0.51168747, 0.74693011, 0.84079149, 0.78772781,
#        0.74799081, 0.54240524, 0.85724387, 0.62330806, 0.62429069,
#        0.54457332]), 'miou': 0.6900303909830827}

# conf_fg_thres: 0.38
# conf_bg_thres: 0.05
# sem_seg_bg_thres: 0.20
# {'iou': array([0.88022535, 0.66357557, 0.39487435, 0.7754758 , 0.55964888,
#        0.65553814, 0.84043403, 0.73772684, 0.84603629, 0.38549724,
#        0.85965508, 0.51364173, 0.80665311, 0.84880154, 0.79510946,
#        0.71163202, 0.53840428, 0.84162868, 0.64642035, 0.61881251,
#        0.49723574]), 'miou': 0.6865250943049903}

# conf_fg_thres: 0.38
# conf_bg_thres: 0.10
# sem_seg_bg_thres: 0.20
# epoch: 5
# {'iou': array([0.88643792, 0.74468328, 0.38746612, 0.7899909 , 0.59164414,
#        0.65087129, 0.83941346, 0.73524788, 0.82381904, 0.38073556,
#        0.84904701, 0.52004846, 0.77296036, 0.84320991, 0.79134494,
#        0.73885334, 0.51583423, 0.85473158, 0.61904223, 0.62378324,
#        0.53305303]), 'miou': 0.6901056149727027}

# conf_fg_thres: 0.37
# conf_bg_thres: 0.10
# sem_seg_bg_thres: 0.20
# {'iou': array([0.88692069, 0.74870023, 0.39253583, 0.78890826, 0.58950421,
#        0.6501888 , 0.84048685, 0.74494095, 0.83452138, 0.38485438,
#        0.85329504, 0.51493272, 0.78379623, 0.84796404, 0.78743848,
#        0.73792823, 0.53931049, 0.8569939 , 0.6329159 , 0.6228718 ,
#        0.51807355]), 'miou': 0.6931943793241652}

# conf_fg_thres: 0.38
# conf_bg_thres: 0.10
# sem_seg_bg_thres: 0.20
# {'iou': array([0.88690976, 0.74937945, 0.39285773, 0.79000848, 0.59058601,
#        0.65115924, 0.83985999, 0.74403928, 0.83335321, 0.38780456,
#        0.8545993 , 0.51613024, 0.78503407, 0.84895781, 0.78717299,
#        0.73770547, 0.53898504, 0.85593493, 0.63303472, 0.62270906,
#        0.51706487]), 'miou': 0.6934898194800675}

# conf_fg_thres: 0.39
# conf_bg_thres: 0.10
# sem_seg_bg_thres: 0.20
# {'iou': array([0.88653729, 0.74872567, 0.39348893, 0.788505  , 0.59021976,
#        0.65061634, 0.84011981, 0.74126288, 0.83224948, 0.38849537,
#        0.85366073, 0.51831338, 0.78867528, 0.84976032, 0.78618811,
#        0.73690854, 0.53590024, 0.85469798, 0.63288372, 0.6218209 ,
#        0.51586925]), 'miou': 0.6930904266329955}

# conf_fg_thres: 0.38
# conf_bg_thres: 0.10
# sem_seg_bg_thres: 0.19
# {'iou': array([0.88442753, 0.74060171, 0.39446964, 0.78091548, 0.58992367,
#        0.65045671, 0.83947962, 0.74375432, 0.83583875, 0.38350829,
#        0.8638191 , 0.52812932, 0.79534189, 0.84992028, 0.79303836,
#        0.73032304, 0.5356102 , 0.85151563, 0.63469017, 0.61283661,
#        0.51191569]), 'miou': 0.6928817146552494}

# conf_fg_thres: 0.38
# conf_bg_thres: 0.10
# sem_seg_bg_thres: 0.21
# {'iou': array([0.88884615, 0.75297591, 0.3832553 , 0.79702716, 0.58431738,
#        0.66016148, 0.84045712, 0.73754817, 0.83004453, 0.38659706,
#        0.84961164, 0.50840907, 0.77753392, 0.84633144, 0.78557259,
#        0.74293639, 0.53802652, 0.85736909, 0.63392686, 0.62989784,
#        0.52920617]), 'miou': 0.6933357991339256}'

# conf_fg_thres: 0.38
# conf_bg_thres: 0.11
# sem_seg_bg_thres: 0.21
# {'iou': array([0.88769839, 0.7524187 , 0.39237498, 0.79272286, 0.59086043,
#        0.64947168, 0.83897332, 0.744491  , 0.82992022, 0.3876024 ,
#        0.85284748, 0.51529128, 0.78086166, 0.84754407, 0.78585034,
#        0.74116341, 0.53916827, 0.85545068, 0.63166508, 0.62272955,
#        0.52274883]), 'miou': 0.6934216488656259}

# conf_fg_thres: 0.38
# conf_bg_thres: 0.09
# sem_seg_bg_thres: 0.21
# {'iou': array([0.88585864, 0.74263481, 0.39434242, 0.78572554, 0.58973254,
#        0.65107018, 0.84143011, 0.73917284, 0.83776116, 0.38620315,
#        0.85670081, 0.51903435, 0.79226419, 0.85001468, 0.7875893 ,
#        0.73291694, 0.53735714, 0.8577103 , 0.63435709, 0.62070654,
#        0.51178556]), 'miou': 0.6930651564335335}

# conf_fg_thres: 0.35
# conf_bg_thres: 0.10
# sem_seg_bg_thres: 0.20
# {'iou': array([0.8871278 , 0.74685901, 0.39226216, 0.7884875 , 0.58640047,
#        0.64885789, 0.84196918, 0.74464052, 0.83576348, 0.3821051 ,
#        0.84983301, 0.51158604, 0.78048423, 0.84493111, 0.78796624,
#        0.73760188, 0.5423675 , 0.85716378, 0.63213419, 0.62651685,
#        0.52409145]), 'miou': 0.6928166378317229}

# conf_fg_thres: 0.35
# conf_bg_thres: 0.05
# sem_seg_bg_thres: 0.25
# {'iou': array([0.88889531, 0.7084661 , 0.37931967, 0.80929941, 0.57456356,
#        0.6520328 , 0.83256292, 0.71728634, 0.83166021, 0.39263413,
#        0.8335448 , 0.4559569 , 0.77541875, 0.83887438, 0.7882266 ,
#        0.73665308, 0.53706571, 0.82553566, 0.61908979, 0.6461027 ,
#        0.54473093]), 'miou': 0.6851390359763927}

# conf_fg_thres: 0.35
# conf_bg_thres: 0.05
# sem_seg_bg_thres: 0.28
# {'iou': array([0.8907701 , 0.76535354, 0.3732555 , 0.78948859, 0.59179668,
#        0.6257649 , 0.83049805, 0.67693125, 0.76966985, 0.35789996,
#        0.81980797, 0.42880295, 0.71668243, 0.80257004, 0.77143013,
#        0.75836487, 0.52016036, 0.81542908, 0.60757335, 0.65696245,
#        0.58687668]), 'miou': 0.6740994626560164}

# conf_fg_thres: 0.38
# conf_bg_thres: 0.10
# sem_seg_bg_thres: 0.17
# {'iou': array([0.87694155, 0.71651934, 0.39905153, 0.76358972, 0.57281463,
#        0.65507046, 0.8389207 , 0.74054755, 0.8410421 , 0.37633843,
#        0.86747628, 0.55617861, 0.81927386, 0.8452262 , 0.79610932,
#        0.71205873, 0.51456094, 0.82803457, 0.6255117 , 0.59572614,
#        0.48907148]), 'miou': 0.6871458973831147}
